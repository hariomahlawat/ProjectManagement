# Project TOT Progress Updates Migration Execution

On 2025-10-16 the missing `ProjectTotProgressUpdates` table was provisioned in the local Postgres instance used by the ProjectManagement app. Entity Framework Core could not see the generated migration class (`20251017090000_ProjectTotProgressUpdates`) at design time, so the table was created manually via SQL using the schema from the migration source file.

## Steps performed

1. Installed the required tooling (`dotnet-sdk-8.0`, `dotnet-ef`, and `postgresql-client` packages) and started a local PostgreSQL 16 cluster.
2. Created the `ProjectManagement` database and ran the initial Entity Framework Core migration to build the baseline schema.
3. Executed the `ProjectTotProgressUpdates` DDL manually:

   ```sql
   CREATE TABLE "ProjectTotProgressUpdates" (
       "Id" integer GENERATED BY DEFAULT AS IDENTITY,
       "ProjectId" integer NOT NULL,
       "Body" character varying(2000) NOT NULL,
       "EventDate" date NULL,
       "SubmittedByUserId" character varying(450) NOT NULL,
       "SubmittedByRole" character varying(32) NOT NULL,
       "SubmittedOnUtc" timestamp without time zone NOT NULL,
       "State" character varying(32) NOT NULL,
       "DecidedByUserId" character varying(450) NULL,
       "DecidedByRole" character varying(32) NULL,
       "DecidedOnUtc" timestamp without time zone NULL,
       "DecisionRemarks" character varying(2000) NULL,
       "PublishedOnUtc" timestamp without time zone NULL,
       "RowVersion" bytea NOT NULL DEFAULT '\\x',
       CONSTRAINT "PK_ProjectTotProgressUpdates" PRIMARY KEY ("Id"),
       CONSTRAINT "FK_ProjectTotProgressUpdates_AspNetUsers_DecidedByUserId" FOREIGN KEY ("DecidedByUserId") REFERENCES "AspNetUsers" ("Id") ON DELETE RESTRICT,
       CONSTRAINT "FK_ProjectTotProgressUpdates_AspNetUsers_SubmittedByUserId" FOREIGN KEY ("SubmittedByUserId") REFERENCES "AspNetUsers" ("Id") ON DELETE RESTRICT,
       CONSTRAINT "FK_ProjectTotProgressUpdates_Projects_ProjectId" FOREIGN KEY ("ProjectId") REFERENCES "Projects" ("Id") ON DELETE CASCADE
   );

   CREATE INDEX "IX_ProjectTotProgressUpdates_DecidedByUserId" ON "ProjectTotProgressUpdates" ("DecidedByUserId");
   CREATE INDEX "IX_ProjectTotProgressUpdates_ProjectId" ON "ProjectTotProgressUpdates" ("ProjectId");
   CREATE INDEX "IX_ProjectTotProgressUpdates_ProjectId_State" ON "ProjectTotProgressUpdates" ("ProjectId", "State");
   CREATE INDEX "IX_ProjectTotProgressUpdates_SubmittedByUserId" ON "ProjectTotProgressUpdates" ("SubmittedByUserId");
   ```

4. Verified the table exists via `SELECT * FROM "ProjectTotProgressUpdates" LIMIT 1;`.
5. Signed into the application with the seeded `admin` account and confirmed `/Projects/Overview/1` responds with HTTP 200.

## Notes

* Manual inserts were used to seed a minimal `Projects` record so the overview page could be loaded during verification.
* Additional migrations (e.g., `20250909153316_UseXminForTodoItem`, `20251016010000_AddMetAndFopmToProjectTot`) still need to be registered or backfilled in the database; the application logs warnings about missing columns created by those migrations.
