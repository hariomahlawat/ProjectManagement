@page "{id:guid}"
@model ProjectManagement.Areas.DocumentRepository.Pages.Documents.ReaderModel
@{
    ViewData["Title"] = "Document reader";
}

@section Styles {
    <link rel="stylesheet" href="~/css/docrepo-reader.css" asp-append-version="true" />
}

<!-- ultra-compact top bar -->
<div class="docreader-topbar">
    <div class="docreader-breadcrumb">
        <a asp-area="" asp-page="/Index" class="docreader-link">Dashboard</a>
        <span class="text-muted">/</span>
        <a asp-area="DocumentRepository" asp-page="/Documents/Index" class="docreader-link">Documents</a>
        <span class="text-muted">/</span>
        <span class="docreader-title" title="@Model.DocumentTitle">
            @Model.DocumentTitle
        </span>
    </div>
    <div class="docreader-actions">
        <a class="btn btn-sm btn-outline-secondary docreader-btn"
           href="@Model.ViewUrl"
           target="_blank"
           rel="noopener">
            Open
        </a>
        @if (Model.IsFileMissing)
        {
            <button class="btn btn-sm btn-primary docreader-btn" type="button" disabled title="File missing from storage">
                Download
            </button>
        }
        else
        {
            <a class="btn btn-sm btn-primary docreader-btn"
               href="@Model.DownloadUrl">
                Download
            </a>
        }
    </div>
</div>

<!-- full-height viewer -->
<div class="docreader-stage">
    @if (Model.IsFileMissing)
    {
        <div class="alert alert-warning m-3" role="alert">
            The document record exists, but the PDF file is missing from storage. Please inform the administrator.
        </div>
    }
    else
    {
        <iframe src="@Model.ViewUrl"
                class="docreader-frame"
                title="Document viewer"
                loading="lazy"></iframe>
    }
</div>
