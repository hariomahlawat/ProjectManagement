@model ProjectManagement.ViewModels.PlanEditVm
<form method="post" asp-page="/Projects/Timeline/EditPlan" asp-route-id="@Model.ProjectId" class="d-flex flex-column h-100">
    @Html.AntiForgeryToken()
    <input type="hidden" name="Input.ProjectId" value="@Model.ProjectId" />

    <div class="flex-grow-1 overflow-auto pe-1">
        <div class="row gy-3">
            @for (var i = 0; i < Model.Rows.Count; i++)
            {
                var row = Model.Rows[i];
                <div class="col-12 border-bottom pb-3">
                    <div class="d-flex justify-content-between align-items-center mb-1">
                        <strong>@row.Name</strong>
                        <span class="text-muted small">@row.Code</span>
                    </div>
                    <div class="row g-2">
                        <div class="col-sm-6">
                            <label for="Rows_@i__PlannedStart" class="form-label">Planned start</label>
                            <input class="form-control" type="date"
                                   id="Rows_@i__PlannedStart"
                                   name="Input.Rows[@i].PlannedStart"
                                   value="@(row.PlannedStart.HasValue ? row.PlannedStart.Value.ToString("yyyy-MM-dd") : null)" />
                        </div>
                        <div class="col-sm-6">
                            <label for="Rows_@i__PlannedDue" class="form-label">Planned due</label>
                            <input class="form-control" type="date"
                                   id="Rows_@i__PlannedDue"
                                   name="Input.Rows[@i].PlannedDue"
                                   value="@(row.PlannedDue.HasValue ? row.PlannedDue.Value.ToString("yyyy-MM-dd") : null)" />
                        </div>
                    </div>
                    <input type="hidden" name="Input.Rows[@i].Code" value="@row.Code" />
                    <input type="hidden" name="Input.Rows[@i].Name" value="@row.Name" />
                </div>
            }
        </div>
    </div>

    <div class="pt-3 mt-3 border-top text-end">
        <button class="btn btn-primary" type="submit">Save plan</button>
    </div>
</form>
