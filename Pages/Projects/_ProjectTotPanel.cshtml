@using ProjectManagement.Models
@model ProjectManagement.Pages.Projects.OverviewModel

@{
    // SECTION: ToT panel visibility
    var showTransferOfTechnology = Model.LifecycleSummary.Status == ProjectLifecycleStatus.Completed;
}

@if (showTransferOfTechnology)
{
    // SECTION: ToT status chip mapping
    var tot = Model.TotSummary;
    var badgeVariant = tot.HasTotRecord
        ? tot.Status switch
        {
            ProjectTotStatus.Completed => "success",
            ProjectTotStatus.InProgress => "info",
            ProjectTotStatus.NotRequired => "secondary",
            _ => "secondary"
        }
        : "secondary";

    var cardModel = new RightColumnSummaryCardViewModel
    {
        IconClass = "bi bi-diagram-3",
        Title = "Transfer of Technology",
        Subtitle = "Status and milestones.",
        StatusText = tot.StatusLabel,
        StatusBadgeClass = $"text-bg-{badgeVariant}",
        BodyPartialName = "_ProjectTotPanelBody",
        BodyModel = Model,
        HeaderActionsPartialName = "_ProjectTotPanelHeaderActions",
        HeaderActionsModel = Model
    };

    <!-- SECTION: ToT summary card -->
    <partial name="_RightColumnSummaryCard" model="cardModel" />
}
