@using ProjectManagement.ViewModels.Projects.IndustryPartners
@model ProjectManagement.ViewModels.Projects.IndustryPartners.LinkProjectDrawerViewModel

@* Section: Link project drawer body *@
<form class="industry-partners-form"
      method="post"
      hx-post="/projects/industry-partners?handler=LinkProject"
      hx-target="#industryPartnerDetail"
      hx-swap="innerHTML"
      hx-include="#industryPartnerId">
    @Html.AntiForgeryToken()

    @* Section: Validation *@
    <div id="linkProjectValidation" class="mb-3">
        @if (!string.IsNullOrWhiteSpace(Model.LinkProjectError))
        {
            <div class="alert alert-danger py-2 mb-0">@Model.LinkProjectError</div>
        }
    </div>

    @* Section: Project selection *@
    <div class="mb-3">
        <label class="form-label" for="projectSearchText">Search Project</label>
        <div class="async-multiselect js-async-multiselect industry-partners-project-select"
             data-name="ProjectId"
             data-source="/api/lookups/projects"
             data-search-placeholder="Search project name"
             data-no-results="No projects found"
             data-loading-text="Searching projects"
             data-remove-label="Remove project"
             data-max-selection="1"
             data-input-id="projectSearchText">
            @if (Model.SelectedProject is not null)
            {
                <input type="hidden"
                       name="ProjectId"
                       value="@Model.SelectedProject.ProjectId"
                       data-label="@Model.SelectedProject.ProjectName" />
            }
        </div>
        <div class="form-text">Select an existing project to link to this partner.</div>
    </div>

    @* Section: Notes *@
    <div class="mb-3">
        <label class="form-label" for="projectNote">Note (optional)</label>
        <textarea id="projectNote" name="Notes" class="form-control" rows="3">@Model.Notes</textarea>
    </div>

    @* Section: Actions *@
    <div class="d-flex justify-content-end gap-2">
        <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="offcanvas">Cancel</button>
        <button type="submit" class="btn btn-primary">Save Association</button>
    </div>
</form>
