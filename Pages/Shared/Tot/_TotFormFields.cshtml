@model ProjectManagement.ViewModels.ITotStatusMilestoneFields
@using Microsoft.AspNetCore.Mvc.Rendering
@using System.Linq
@using ProjectManagement.Models
@using ProjectManagement.ViewModels
@{
    var statusOptions = ViewData[TotFormFieldsViewDataKeys.StatusOptions] as IEnumerable<SelectListItem> ?? Enumerable.Empty<SelectListItem>();
    var statusLabel = ViewData[TotFormFieldsViewDataKeys.StatusLabel] as string ?? "Status";
    var showMilestoneHelp = ViewData[TotFormFieldsViewDataKeys.ShowMilestoneHelp] as bool? ?? false;
}

<div class="mb-3">
    <label asp-for="Status" class="form-label">@statusLabel</label>
    @if (statusOptions.Any())
    {
        <select asp-for="Status" class="form-select" asp-items="statusOptions"></select>
    }
    else
    {
        <select asp-for="Status" class="form-select">
            @foreach (ProjectTotStatus status in Enum.GetValues<ProjectTotStatus>())
            {
                <option value="@status">@status</option>
            }
        </select>
    }
    <span asp-validation-for="Status" class="text-danger"></span>
</div>

<div class="row g-3">
    <div class="col-md-6">
        <label class="form-label" for="@Html.IdFor(m => m.StartYear)">Start date</label>
        <div class="row g-2">
            <div class="col-4">
                <input asp-for="StartYear" class="form-control" type="number" min="1900" max="2100" placeholder="yyyy" inputmode="numeric" />
                <span asp-validation-for="StartYear" class="text-danger"></span>
            </div>
            <div class="col-4">
                <input asp-for="StartMonth" class="form-control" type="number" min="1" max="12" placeholder="mm" inputmode="numeric" />
                <span asp-validation-for="StartMonth" class="text-danger"></span>
            </div>
            <div class="col-4">
                <input asp-for="StartDay" class="form-control" type="number" min="1" max="31" placeholder="dd" inputmode="numeric" />
                <span asp-validation-for="StartDay" class="text-danger"></span>
            </div>
        </div>
        @if (showMilestoneHelp)
        {
            <div class="form-text">Required (at least the year) when ToT is in progress. Optional when ToT is completed.</div>
        }
    </div>
    <div class="col-md-6">
        <label class="form-label" for="@Html.IdFor(m => m.CompletionYear)">Completion date</label>
        <div class="row g-2">
            <div class="col-4">
                <input asp-for="CompletionYear" class="form-control" type="number" min="1900" max="2100" placeholder="yyyy" inputmode="numeric" />
                <span asp-validation-for="CompletionYear" class="text-danger"></span>
            </div>
            <div class="col-4">
                <input asp-for="CompletionMonth" class="form-control" type="number" min="1" max="12" placeholder="mm" inputmode="numeric" />
                <span asp-validation-for="CompletionMonth" class="text-danger"></span>
            </div>
            <div class="col-4">
                <input asp-for="CompletionDay" class="form-control" type="number" min="1" max="31" placeholder="dd" inputmode="numeric" />
                <span asp-validation-for="CompletionDay" class="text-danger"></span>
            </div>
        </div>
        @if (showMilestoneHelp)
        {
            <div class="form-text">Required (at least the year) when ToT is completed.</div>
        }
    </div>
</div>

<div class="mb-3 mt-3">
    <label asp-for="MetDetails" class="form-label">MET details</label>
    <textarea asp-for="MetDetails" class="form-control" rows="2" maxlength="2000"></textarea>
    <span asp-validation-for="MetDetails" class="text-danger"></span>
</div>

<div class="row g-3">
    <div class="col-md-6">
        <label asp-for="MetCompletedOn" class="form-label">MET completed on</label>
        <input asp-for="MetCompletedOn" class="form-control" type="date" />
        <span asp-validation-for="MetCompletedOn" class="text-danger"></span>
    </div>
    <div class="col-md-6">
        <label asp-for="FirstProductionModelManufactured" class="form-label">First production model manufactured?</label>
        <select asp-for="FirstProductionModelManufactured" class="form-select">
            <option value="">Not specified</option>
            <option value="true">Yes</option>
            <option value="false">No</option>
        </select>
        <span asp-validation-for="FirstProductionModelManufactured" class="text-danger"></span>
    </div>
</div>

<div class="mb-3 mt-3">
    <label asp-for="FirstProductionModelManufacturedOn" class="form-label">Manufactured on</label>
    <input asp-for="FirstProductionModelManufacturedOn" class="form-control" type="date" />
    <span asp-validation-for="FirstProductionModelManufacturedOn" class="text-danger"></span>
</div>
