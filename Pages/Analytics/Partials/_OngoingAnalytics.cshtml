@model ProjectManagement.Models.Analytics.OngoingAnalyticsVm
@using System.Text.Json

@{
    // SECTION: Ongoing analytics serialization
    var jsonOptions = new JsonSerializerOptions
    {
        PropertyNamingPolicy = JsonNamingPolicy.CamelCase
    };
    // END SECTION
}

<section class="analytics-panel analytics-panel--ongoing" aria-label="Ongoing projects analytics">
    <!-- SECTION: Ongoing analytics layout -->
    <div class="analytics-layout">
        <div class="analytics-grid analytics-grid--ongoing">

            <!-- Card: category distribution -->
            <article class="analytics-card">
                <header class="analytics-card__header">
                    <h2 class="analytics-card__title">Ongoing projects by category</h2>
                    <p class="analytics-card__meta">Breakdown of ongoing projects in each project category.</p>
                </header>
                <div class="analytics-card__body">
                    <div class="analytics-card__chart">
                        <canvas id="ongoing-by-category-chart"
                                aria-label="Ongoing projects by category"
                                role="img"
                                data-series='@Html.Raw(JsonSerializer.Serialize(Model.ByCategory, jsonOptions))'></canvas>
                    </div>
                </div>
            </article>

            <!-- Card: stage distribution -->
            <article class="analytics-card">
                <header class="analytics-card__header">
                    <h2 class="analytics-card__title">Ongoing projects by current stage</h2>
                    <p class="analytics-card__meta">How many ongoing projects are currently in each stage.</p>
                </header>
                <div class="analytics-card__body">
                    <div class="analytics-card__chart">
                        <canvas id="ongoing-by-stage-chart"
                                aria-label="Ongoing projects by current stage"
                                role="img"
                                data-series='@Html.Raw(JsonSerializer.Serialize(Model.ByStage, jsonOptions))'></canvas>
                    </div>
                </div>
            </article>

            <!-- Card: time-in-stage -->
            <article class="analytics-card analytics-card--wide">
                <header class="analytics-card__header">
                    <h2 class="analytics-card__title">Average time spent in each stage</h2>
                    <p class="analytics-card__meta">
                        Average number of days ongoing projects spend in each stage.
                    </p>
                </header>
                <div class="analytics-card__body">
                    <div class="analytics-card__chart">
                        <canvas id="ongoing-stage-duration-chart"
                                aria-label="Average time spent in each stage"
                                role="img"
                                data-series='@Html.Raw(JsonSerializer.Serialize(Model.AvgStageDurations, jsonOptions))'></canvas>
                    </div>
                </div>
            </article>

        </div>
    </div>
    <!-- END SECTION -->
</section>
